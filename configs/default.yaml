seed: 42

data:
  # –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞, –≥–¥–µ –ª–µ–∂–∞—Ç —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –≤–∏–¥–∞ XXX_FINAL
  regions_root: "./data/train"   # ‚Üê —É–∫–∞–∂–∏ —Å–≤–æ–π –ø—É—Ç—å –∫ –ø–∞–ø–∫–∞–º 002_–î–ï–ú–ò–î–û–í–ö–ê_FINAL, 003_–õ–£–ë–ù–û_FINAL, ...
  # –ö–∞–∫–æ–π —Ä–∞—Å—Ç—Ä –±—Ä–∞—Ç—å –∫–∞–∫ Hillshade –≤–Ω—É—Ç—Ä–∏ 02_*_Li_–∫–∞—Ä—Ç—ã
  hillshade_channels:
    - "*_Li_–∫–∞—Ä—Ç—ã/*_Lidar_c.tif"
    - "*_Li_–∫–∞—Ä—Ç—ã/*_Lidar_ch.tif"
    - "*_Li_–∫–∞—Ä—Ç—ã/*_Lidar_g.tif"
    - "*_Li_–∫–∞—Ä—Ç—ã/*_Lidar_i.tif"

  # –ú–∞—Å–∫–∏ –±–µ—Ä—ë–º –∏–∑: 06_*_—Ä–∞–∑–º–µ—Ç–∫–∞/Li/*.geojson
  labels_subpath: "*_—Ä–∞–∑–º–µ—Ç–∫–∞/Li/*.geojson"

  # –ö–ª–∞—Å—Å—ã –∏ –∏—Ö –≤–µ—Å–∞ –ø–æ–¥ F2/–ª–æ—Å—Å—ã (–ø—Ä–∏–º–µ—Ä ‚Äî –ø—Ä–∞–≤—å –ø–æ–¥ –≤–∞—à –±—Ä–∏—Ñ)
  classes:
    selishcha: 5.0
    kurgany: 4.0
    karavannye_puti: 3.0
    gorodishcha: 2.0
    fortifikatsii: 2.0
    dorogi: 1.0
    pashni: 1.0
    yamy: 1.0
    inoe: 0.25

  boundary_mode:
    gorodishcha:
      enabled: true
      ring_width_m: 3.0
    selishcha:
      enabled: true
      ring_width_m: 4.0
    kurgany:
      enabled: true
      ring_width_m: 4.0


  # –°–ª–∞–π–¥–∏–Ω–≥-–æ–∫–Ω–∞ (–µ—Å–ª–∏ —Ç–∏–ª–∞ –Ω–µ—Ç)
  tile_size: 512
  tile_stride: 384    # overlap
  class_buffer_m:            # —Ä–∞—Å—à–∏—Ä–∏–º —Ç–æ–Ω–∫–∏–µ –∫–ª–∞—Å—Å—ã –≤ —Ç–∞—Ä–≥–µ—Ç–µ
    dorogi: 4.0
    karavannye_puti: 4.5
    gorodishcha: 1.5

  train:
    batch_size: 2         # üîπ —É–º–µ–Ω—å—à–µ–Ω–æ (—á—Ç–æ–±—ã –Ω–µ —É–ø–µ—Ä–µ—Ç—å—Å—è –≤ GPU-RAM MPS)
    num_workers: 0        # üîπ 0 –¥–ª—è macOS - –∏–∑–±–µ–≥–∞–µ–º –ø—Ä–æ–±–ª–µ–º —Å multiprocessing/shared memory
    epochs: 20            # üîπ 5 ‚Äî —Ç–µ—Å—Ç, 10 ‚Äî –±–∞–∑–æ–≤—ã–π –ø—Ä–æ–≥–æ–Ω (~3‚Äì4 —á)
    lr: 1e-4             # üîπ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ, —á—Ç–æ–±—ã –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–π –±–∞—Ç—á
    weight_decay: 1e-4
    amp: false            # üîπ AMP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–∞ MPS (–≤—ã–∫–ª—é—á–∞–µ–º)
    oversample: true
    oversample_factor: 3.0
    grad_accum_steps: 2 # –∏–º–∏—Ç–∏—Ä—É–µ–º bsz=4 
    limit_regions: 4      # üîπ –Ω–∞—á–Ω–∏ —Å 3‚Äì4 —Ä–µ–≥–∏–æ–Ω–æ–≤, –ø–æ—Ç–æ–º —É–≤–µ–ª–∏—á—å
    limit_val_regions: 1  # üîπ –±—ã—Å—Ç—Ä–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ 1 —Ä–µ–≥–∏–æ–Ω–µ
    scheduler:
      name: cosine
      warmup_epochs: 1
      min_lr: 1e-5

model:
  encoder: "resnet18"   # üîπ –±—ã—Å—Ç—Ä–µ–µ –∏ –ª–µ–≥—á–µ (–¥–ª—è CPU/MPS)
  encoder_weights: null  # üîπ null –¥–ª—è 4 –∫–∞–Ω–∞–ª–æ–≤ (imagenet —Ç–æ–ª—å–∫–æ –¥–ª—è 3)
  in_channels: 4        # üîπ 4 hillshade –∫–∞–Ω–∞–ª–∞ (c, ch, g, i)

log:
  out_dir: "runs/default"

# –ü–æ—Ä–æ–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ (–±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω, –µ—Å–ª–∏ —Å–¥–µ–ª–∞–µ—à—å —Ç—é–Ω–∏–Ω–≥)
thresholds:                  # –¥–ª—è F2 –ø–æ–ø—Ä–æ–±—É–π –Ω–∏–∂–µ
  dorogi: 0.25
  karavannye_puti: 0.25
  gorodishcha: 0.30
  fortifikatsii: 0.30
  selishcha: 0.30
  pashni: 0.40
  yamy: 0.30
  kurgany: 0.30
  inoe: 0.50